SECTION "Setup", ROM0[$100]
JP start
SECTION "Main", ROM0[$150]
;----------------------
generate_tile: macro  
	
	LD BC, \1
	CALL set_tile

endm
;----------------------
get_background: macro
	
	LD BC, \1
	LD DE, 1024
	LD HL, \2
	CALL load_map
endm
;----------------------
;1 -> pressed
;0-> not pressed
set_pressed: macro
	LD A, \1
	LD [key_down],A
endm
;----------------------
get_input_value: macro
	LD A, $20
	LD [$FF00], A
	LD A, [$FF00]
	LD A, [$FF00]
	LD A, [$FF00]
	LD A, [$FF00]
	LD A, [$FF00]
endm
;----------------------
;\1 check bit
;\2 false? jump here
key_pressed: macro
	BIT \1, A
	JP NZ, \2
	jp check_input
endm
;----------------------
;\1 bit to check
;\2 check bit != true ? call \2
;\3 how much sub
;\4 if prev index isn' t 10, call \3
check_prev: macro

	BIT \1, A
	JP NZ, \2
	ld h, $98
	ld a, [index]
	sbc \3
	ld l, a
	ld a, [hl]
	ld [prev_index],a 
	cp $10
	jp nz,\4
	;if true
endm
;--------------------------------------------
;\3 how much add
check_next: macro
	BIT \1, A
	JP NZ, \2

    ;check prev index
	ld h, $98
	ld a, [index]
	
	adc \3
	ld l, a
	;------ save the right value for swap
	;------ for compare
	ld a, [hl]
	ld [prev_index],a 
	;is prev 0? no = change , yes = end
	cp $10
	jp nz,\4

endm
;--------------------------------------------
swap_tile_sub: macro
	call turn_off_lcd
	;High byte
	ld h, $98
	;dec index
	ld a, [index]
	ld l, a
	ld a, [prev_index]
 	ld [hl],a 	

	ld h, $98
	ld a, [index]
	sbc \1 
	ld l, a
	ld a, $00 
 	ld [hl],a 	
	;Set current Index
	ld a , l 
	ld [index], a 

	call turn_on_lcd
endm
;--------------------------------------------
swap_tile_add: macro
	call turn_off_lcd
	;High byte
	ld h, $98
	ld a, [index]
	ld l, a
	ld a, [prev_index]
	; swap current with prev
 	ld [hl],a 	
	ld h, $98
	ld a, [index]
	adc \1
	ld l, a
	ld a, $00 
 	ld [hl],a 	

;Set Index
	ld a , l 
	ld [index], a 

	call turn_on_lcd
endm
;--------------------------------------------
compare_index: macro
	ld h, $98
	ld a, \1
	ld l, a
	ld a, [hl]
	;check victory
	cp \2
endm
;--------------------------------------------
win_check: macro
	ld a ,[index]
	sbc \1
	compare_index a,\2
	jp nz ,return
endm
;--------------------------------------------
start:
    ;CLEAR
	LD SP, $FFFE
	CALL clear_vram
	CALL clear_oam
    
	ld A, $10
	ld [index],A

    ;INDIRIZZO VRAM IN HL
	LD HL, $8000

    LD E,$00
    LD E,$10

;PUSH TILE IN MEMORY
;----------------------------------
	generate_tile Sprite_White
   	generate_tile Sprite0
	generate_tile Sprite1
	generate_tile Sprite2
	generate_tile Sprite3
	generate_tile Sprite4
	generate_tile Sprite5
	generate_tile Sprite6
	generate_tile Sprite7
	generate_tile Sprite8
	generate_tile Sprite9
	generate_tile Sprite10
	generate_tile Sprite11
	generate_tile Sprite12
	generate_tile Sprite13
	generate_tile Sprite14
	generate_tile Sprite_empty
	generate_tile Sprite_A
	generate_tile Sprite_M
	generate_tile Sprite_up_angle_left
	generate_tile Sprite_up_angle_right
	generate_tile Sprite_bottom_angle_left
	generate_tile Sprite_bottom_angle_right
	generate_tile Sprite_horizontal_down
	generate_tile Sprite_horizontal_up
	generate_tile Sprite_vertical_left
	generate_tile Sprite_vertical_right
	generate_tile Sprite_Y
	generate_tile Sprite_O
	generate_tile Sprite_U
	generate_tile Sprite_W
	generate_tile Sprite_I
	generate_tile Sprite_N
	generate_tile Sprite_exclamation

;-----------------------------------
	;LOAD MAP
	get_background window_map , $9800 
;	get_background bg_name , $9C00 
	set_pressed $00
    CALL sprite_palette0
;-----------------------------------
	;SET WHITE INDEX \TODO: FIND THIS 
   	ld a, $CB
   ;	ld a, $CA
    
	LD [index],a

;SET WINDOW POS Y
	ld a, 70
	ld [$FF4A],a

	 ; -------------
    CALL turn_on_lcd
    ld a, 0
	ld [counter],a 
gameloop:
	LD A, [$FF44]
	CP $90
	CALL Z, in_vblank
	CALL wait_hblank
	CALL wait_non_hblank
	JP gameloop

in_vblank:
	;Check if is out of screen
	LD A,[$FF4B]
	CP $A0
	jp nz,move_window
	;reset x pos of window
	ld a, $00
	ld [$FF4B],a
	jp get_input
move_window:
	LD HL, $FF4B
    inc [hl]
get_input:	
    ;GESTISCO IL BOUNCINESS, PROBLEMA DELL' HARDWARE DELL' EPOCA
    ; PRIMA SELEZIONO LA MODALITA ACCENDENDO IL BIT 5 
	get_input_value

checkbit0:
	key_pressed 0,checkbit1
	
checkbit1:
	key_pressed 1,checkbit2

checkbit2:
	key_pressed 2,checkbit3

checkbit3:
	key_pressed 3,set_bool

set_bool:
	set_pressed $00

check_input:
	LD A, [key_down]
	CP $00
	JP NZ,end
	get_input_value
   
check_left:
	check_prev 1,check_right, $01,change_left
	jp end

change_left:   
	set_pressed $01
	swap_tile_sub $01
	jp end

check_right:
	check_next 0,check_up,$01,change_right
	jp end

change_right:   
	set_pressed $01
	swap_tile_add $01
	jp end

check_up:
	check_prev 2,check_down, $20,change_up
	jp end

change_up:   
	set_pressed $01
	swap_tile_sub $20
	jp end

check_down:
	check_next 3,end,$20,change_down
	jp end

change_down:   
	set_pressed $01
	swap_tile_add $20

end:
	ld a,[index]
	cp $CB
	;ld a,[index]
;	compare_index a, $CB
	jp nz,return
	;CALL black_palette
	; sbc \1
	; compare_index a,\2
	; jp nz ,return
;	sbc $01
    win_check $01, $0F
	win_check $02, $0E
	win_check $03, $0D
	win_check $20, $0C
	win_check $21, $0B
	win_check $22, $0A
	win_check $23, $09
	win_check $40, $08
	win_check $41, $07
	win_check $42, $06
	win_check $43, $05
	win_check $60, $04
	win_check $61, $03
	win_check $62, $02
	win_check $63, $01
	call black_palette
	get_background bg_name , $9C00 
	
return:
	RET

wait_vblank:
	LD A, [$FF44]
	CP $90
	JP NZ, wait_vblank
	RET

wait_hblank:
	LD A, [$FF41]
	AND $03
	JP NZ, wait_hblank
	RET

wait_non_hblank:
	LD A, [$FF41]
	AND $03
	JP Z, wait_non_hblank
	RET

turn_off_lcd:
	CALL wait_vblank
	XOR A
	LD [$FF40], A
	RET

AdjustPos:
	ld a,[$ff4a]
	dec a
	ld [$ff4A],a
	ret
turn_on_lcd:
	LD A,$F3
	LD [$FF40], A
	RET

clear_vram:
	CALL turn_off_lcd
	XOR A
	LD HL, $9FFF
clear_vram_loop:
	LD [HL-], A
	BIT 7, H
	JP NZ, clear_vram_loop
	RET

black_palette:
	LD A, $03
	LD [$FF47], A
	RET

white_palette:
	LD A, $C0
	LD [$FF47], A
	RET

sprite_palette0:
	LD A, $e4
	LD [$FF48], A
	RET

clear_oam:
	LD HL, $FE00
clear_oam_loop:
	XOR A
	LD [HL+], A
	LD A, $A0
	CP A, L
	JP NZ, clear_oam_loop
	RET
set_tile:
	LD D, 0
set_tile_loop:
	LD A, [BC]
    LD [HL+], A
	INC BC
	INC D
	LD A, D
	CP E
	JP NZ, set_tile_loop
    RET

load_map:
	;map in ROM
	LD A, [BC]
	LD [HL+], A
	INC BC
	DEC DE
	LD A,D
	OR E
	JP NZ, load_map
	RET

Sprite_White:
DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

Sprite_Block:
DB $FF,$00,$81,$00,$81,$00,$81,$00,$81,$00,$81,$00,$81,$00,$FF,$00

Sprite0:
DB $00,$00,$18,$00,$38,$00,$18,$00,$18,$00,$18,$00,$18,$00,$3C,$00

Sprite1:
DB $00,$00,$7C,$00,$7C,$00,$04,$00,$7C,$00,$40,$00,$7C,$00,$7C,$00

Sprite2:
DB $00,$00,$3C,$00,$3C,$00,$0C,$00,$18,$00,$0C,$00,$3C,$00,$3C,$00

Sprite3:
DB $00,$00,$60,$00,$60,$00,$60,$00,$6C,$00,$7C,$00,$7C,$00,$0C,$00

Sprite4:
DB $00,$00,$7C,$00,$7C,$00,$60,$00,$78,$00,$1C,$00,$7C,$00,$78,$00

Sprite5:
DB $00,$00,$7C,$00,$7C,$00,$60,$00,$7C,$00,$6C,$00,$7C,$00,$7C,$00

Sprite6:
DB $00,$00,$7C,$00,$7C,$00,$0C,$00,$0C,$00,$0C,$00,$0C,$00,$0C,$00

Sprite7:
DB $00,$00,$3C,$00,$66,$00,$7E,$00,$3C,$00,$66,$00,$7E,$00,$3C,$00

Sprite8:
DB $00,$00,$7C,$00,$7C,$00,$6C,$00,$7C,$00,$7C,$00,$0C,$00,$0C,$00

Sprite9:
DB $00,$00,$5E,$00,$5E,$00,$52,$00,$52,$00,$52,$00,$5E,$00,$5E,$00

Sprite10:
DB $00,$00,$22,$00,$66,$00,$22,$00,$22,$00,$22,$00,$22,$00,$22,$00

Sprite11:
DB $00,$00,$5E,$00,$5E,$00,$46,$00,$5E,$00,$58,$00,$5E,$00,$5E,$00

Sprite12:
DB $00,$00,$5E,$00,$5E,$00,$46,$00,$4C,$00,$46,$00,$5E,$00,$5E,$00

Sprite13:
DB $00,$00,$50,$00,$50,$00,$50,$00,$52,$00,$5E,$00,$5E,$00,$42,$00

Sprite14:
DB $00,$00,$5E,$00,$5E,$00,$58,$00,$4C,$00,$46,$00,$5E,$00,$5C,$00

Sprite_empty:
DB $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF

Sprite_up_angle_left:
DB $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FE,$FE,$FC,$FE,$F8,$F8

Sprite_up_angle_right:
DB $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$7F,$7F,$3F,$3F,$1F,$1F

Sprite_bottom_angle_left:
DB $F8,$F8,$FC,$FC,$FE,$FE,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF

Sprite_bottom_angle_right:
DB $1F,$1F,$3F,$3F,$7F,$7F,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF

Sprite_vertical_left:
DB $F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8,$F8

Sprite_vertical_right:
DB $1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F,$1F

Sprite_horizontal_up:
DB $FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$00,$00,$00,$00,$00,$00,$00

Sprite_horizontal_down:
DB $00,$00,$00,$00,$00,$00,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF

Sprite_A:
DB $00,$00,$3C,$00,$24,$00,$3C,$00,$24,$00,$24,$00,$24,$00,$00,$00

Sprite_M:
DB $00,$00,$3E,$00,$2A,$00,$2A,$00,$2A,$00,$2A,$00,$2A,$00,$00,$00

Sprite_V:
DB $00,$00,$81,$00,$42,$00,$24,$00,$18,$00,$18,$00,$18,$00,$00,$00

Sprite_R:
DB $00,$00,$78,$00,$48,$00,$78,$00,$50,$00,$48,$00,$44,$00,$00,$00

Sprite_Y:
DB $00,$00,$66,$66,$66,$66,$7E,$7E,$7E,$7E,$06,$06,$06,$06,$06,$06

Sprite_O:
DB $00,$00,$7E,$7E,$7E,$7E,$66,$66,$66,$66,$66,$66,$7E,$7E,$7E,$7E

Sprite_U:
DB $00,$00,$66,$66,$66,$66,$66,$66,$66,$66,$66,$66,$7E,$7E,$7E,$7E

Sprite_W:
DB $00,$00,$C3,$C3,$C3,$C3,$C3,$C3,$C3,$C3,$DB,$DB,$FF,$FF,$E7,$E7

Sprite_I:
DB $00,$00,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18

Sprite_N:
DB $00,$00,$C3,$C3,$E3,$E3,$F3,$F3,$DB,$DB,$CF,$CF,$C7,$C7,$C3,$C3

Sprite_exclamation:
DB $00,$00,$18,$18,$18,$18,$18,$18,$18,$18,$00,$00,$18,$18,$18,$18

; window_map:
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,$13,$18,$18,$18,$18,$14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,$19,$01,$02,$03,$04,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,$19,$05,$06,$07,$08,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,$19,$09,$0A,$0C,$0F,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,$19,$0D,$0E,$00,$0B,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,$15,$17,$17,$17,$17,$16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
window_map:
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,$10,$10,$10,$10,$10,$10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,$10,$0D,$01,$07,$06,$10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,$10,$08,$0A,$0E,$05,$10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,$10,$09,$0F,$0C,$03,$10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,$10,$04,$02,$0B,$00,$10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,$10,$10,$10,$10,$10,$10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0


;DB 0,16,16,16,16,16,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,16,$08,$0A,$0E,$05,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,16,$0D,$01,$07,$06,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,16,$09,$0F,$0C,$03,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,16,$04,$02,$0B,$00,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,16,16,16,16,16,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
; DB 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
; DB 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1

bg_name:
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB $13,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB $19,0,0,0,0,0,0,0,0,0,0,0,0,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB $19,0,0,0,0,0,0,0,0,0,0,0,0,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB $19,0,$1B,$1C,$1D,0,$1E,$1F,$20,$21,$21,$21,0,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB $19,0,0,0,0,0,0,0,0,0,0,0,0,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB $19,0,0,0,0,0,0,0,0,0,0,0,0,$1A,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB $15,$17,$17,$17,$17,$17,$17,$17,$17,$17,$17,$17,$17,$16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1
DB 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
DB 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
SECTION "VARIABLES", WRAM0[$C000]

key_down:
DS 1
scroll_var:
DS 1
sprite_y:
DS 1
sprite_x:
DS 1
swap_x:
DS 1
swap_y:
DS 1
index:
DS 2 
next_index:
DS 1
index_Pos:
DS 1
prev_index:
DS 1

counter:
DS 1



